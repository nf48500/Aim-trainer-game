<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aim Trainer â€” Simple HTML Game</title>
  <style>
    :root {
      --bg: #0f1220;
      --panel: #171a2b;
      --accent: #8bd3ff;
      --accent2: #a7ff83;
      --text: #e9eefb;
      --muted: #9aa6c8;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 800px at 70% -10%, #1b1f35, var(--bg));
      color: var(--text); display: grid; place-items: center; min-height: 100vh;
      padding: 18px;
    }
    .wrap {
      width: min(900px, 92vw);
      display: grid; gap: 14px;
    }
    header {
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      background: linear-gradient(180deg, #1a1e33, var(--panel));
      padding: 14px 16px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,.35);
    }
    h1 { font-size: 18px; margin: 0; letter-spacing:.4px; color: #d8e4ff; }
    .stats { display:flex; gap: 14px; flex-wrap: wrap; align-items: center; }
    .pill {
      padding: 6px 10px; border-radius: 999px; background: #12162a; border: 1px solid #2a3052;
      font-size: 13px; color: var(--muted);
    }
    .pill b { color: var(--text); }
    .btn {
      border: 1px solid #2c3258; background: #12162a; color: var(--text);
      padding: 10px 14px; border-radius: 12px; cursor: pointer; font-weight: 600;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover { background:#151a33; border-color:#3a4272; }
    .btn:active { transform: translateY(1px) scale(.99); }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .canvas-wrap {
      position: relative; background: #0b0e1b; border:1px solid #242a4a; border-radius: 18px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02), 0 20px 60px rgba(0,0,0,.4);
      padding: 12px;
    }
    canvas { width: 100%; height: 420px; display:block; border-radius: 12px; background: #0a0e18; }
    .overlay {
      position:absolute; inset:12px; display:grid; place-items:center; pointer-events:none;
      border-radius: 12px;
    }
    .msg {
      text-align:center; background: rgba(10,14,24,.72); backdrop-filter: blur(6px);
      padding: 18px 20px; border: 1px solid #253056; border-radius: 14px;
      box-shadow: 0 6px 30px rgba(0,0,0,.4);
    }
    .msg h2 { margin:0 0 8px; font-size: 20px; color:#d9e6ff; }
    .msg p { margin: 0; color: #b7c3e6; font-size: 14px; }
    footer { color: #97a5cd; font-size: 13px; text-align:center; }
    code { background:#0f1330; padding:2px 6px; border-radius:6px; border:1px solid #2a315a; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ðŸŽ¯ Aim Trainer (HTML + JS)</h1>
      <div class="stats">
        <div class="pill">Score: <b id="score">0</b></div>
        <div class="pill">Time: <b id="time">30.0s</b></div>
        <div class="pill">Hit %: <b id="acc">0%</b></div>
        <div class="pill">Best: <b id="best">0</b></div>
      </div>
      <div class="row">
        <button class="btn" id="btnStart">Start</button>
        <button class="btn" id="btnReset">Reset</button>
      </div>
    </header>

    <div class="canvas-wrap">
      <canvas id="game" width="900" height="420" aria-label="Aim trainer game canvas"></canvas>
      <div class="overlay" id="overlay">
        <div class="msg" id="message">
          <h2>Click the dot!</h2>
          <p>Press <b>Start</b> or hit <code>Space</code> to begin. Click the moving dot to score.</p>
          <p>Game lasts 30 seconds. Good luck! ðŸ’ª</p>
        </div>
      </div>
    </div>

    <footer>
      Tips: You can also press <code>R</code> to reset. The dot gets a little smaller each hit. Try to keep your accuracy high!
    </footer>
  </div>

  <script>
    (function () {
      const canvas = document.getElementById('game');
      const ctx = canvas.getContext('2d');
      const scoreEl = document.getElementById('score');
      const timeEl = document.getElementById('time');
      const accEl = document.getElementById('acc');
      const bestEl = document.getElementById('best');
      const overlay = document.getElementById('overlay');
      const message = document.getElementById('message');
      const btnStart = document.getElementById('btnStart');
      const btnReset = document.getElementById('btnReset');

      // Retina support
      function fitCanvas() {
        const cssWidth = canvas.clientWidth;
        const cssHeight = canvas.clientHeight;
        const dpr = Math.min(window.devicePixelRatio || 1, 2);
        canvas.width = Math.round(cssWidth * dpr);
        canvas.height = Math.round(cssHeight * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }
      fitCanvas();
      addEventListener('resize', fitCanvas);

      // Game state
      const state = {
        running: false,
        score: 0,
        hits: 0,
        shots: 0,
        t: 0,
        timeLimit: 30.0, // seconds
        lastTime: 0,
        circle: {
          x: 150, y: 100, r: 28,
          vx: 180, vy: 160 // px/s
        }
      };

      // Load best score
      const BEST_KEY = 'aim_trainer_best';
      bestEl.textContent = Number(localStorage.getItem(BEST_KEY) || 0);

      function rand(min, max) { return Math.random() * (max - min) + min; }

      function resetCircle(harder = false) {
        const pad = 20;
        state.circle.x = rand(pad, canvas.clientWidth - pad);
        state.circle.y = rand(pad, canvas.clientHeight - pad);
        if (harder) {
          state.circle.r = Math.max(12, state.circle.r - 1.8);
          const speedUp = 1.04;
          state.circle.vx *= speedUp;
          state.circle.vy *= speedUp;
        } else {
          state.circle.r = 28;
          state.circle.vx = 180; state.circle.vy = 160;
        }
      }

      function startGame() {
        if (state.running) return;
        state.running = true;
        overlay.style.display = 'none';
        state.score = 0; state.hits = 0; state.shots = 0;
        state.t = state.timeLimit; state.lastTime = performance.now();
        scoreEl.textContent = '0';
        accEl.textContent = '0%';
        resetCircle(false);
        requestAnimationFrame(loop);
      }

      function endGame() {
        state.running = false;
        overlay.style.display = 'grid';
        const best = Math.max(Number(localStorage.getItem(BEST_KEY) || 0), state.score);
        localStorage.setItem(BEST_KEY, best);
        bestEl.textContent = best;
        message.innerHTML = `
          <h2>Time!</h2>
          <p>Your score: <b>${state.score}</b> â€” Accuracy: <b>${accuracy()}%</b></p>
          <p>Press <b>Start</b> or <code>Space</code> to try again.</p>
        `;
      }

      function accuracy() {
        if (state.shots === 0) return 0;
        return Math.round((state.hits / state.shots) * 100);
      }

      // Input
      canvas.addEventListener('pointerdown', (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        if (!state.running) return;

        state.shots++;
        const dx = x - state.circle.x;
        const dy = y - state.circle.y;
        const hit = Math.hypot(dx, dy) <= state.circle.r;

        if (hit) {
          state.hits++;
          state.score += Math.max(1, Math.floor(35 - state.circle.r));
          scoreEl.textContent = state.score;
          resetCircle(true);
        }
        accEl.textContent = accuracy() + '%';
      });

      document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') { e.preventDefault(); state.running ? null : startGame(); }
        if (e.key.toLowerCase() === 'r') { e.preventDefault(); hardReset(); }
      });

      btnStart.addEventListener('click', () => startGame());
      btnReset.addEventListener('click', () => hardReset());

      function hardReset() {
        state.running = false;
        state.score = 0; state.hits = 0; state.shots = 0;
        scoreEl.textContent = '0'; accEl.textContent = '0%'; timeEl.textContent = state.timeLimit.toFixed(1) + 's';
        resetCircle(false);
        overlay.style.display = 'grid';
        message.innerHTML = `
          <h2>Click the dot!</h2>
          <p>Press <b>Start</b> or hit <code>Space</code> to begin. Click the moving dot to score.</p>
          <p>Game lasts 30 seconds. Good luck! ðŸ’ª</p>
        `;
        draw(0); // render idle state
      }

      // Loop
      function loop(now) {
        if (!state.running) return;
        const dt = Math.min(0.05, (now - state.lastTime) / 1000); // clamp to avoid huge delta
        state.lastTime = now;

        // Update timer
        state.t -= dt;
        if (state.t <= 0) {
          state.t = 0;
          timeEl.textContent = '0.0s';
          draw(dt);
          endGame();
          return;
        }
        timeEl.textContent = state.t.toFixed(1) + 's';

        // Move circle (bounce within canvas)
        state.circle.x += state.circle.vx * dt;
        state.circle.y += state.circle.vy * dt;

        const w = canvas.clientWidth, h = canvas.clientHeight, r = state.circle.r;
        if (state.circle.x < r) { state.circle.x = r; state.circle.vx *= -1; }
        if (state.circle.x > w - r) { state.circle.x = w - r; state.circle.vx *= -1; }
        if (state.circle.y < r) { state.circle.y = r; state.circle.vy *= -1; }
        if (state.circle.y > h - r) { state.circle.y = h - r; state.circle.vy *= -1; }

        draw(dt);
        requestAnimationFrame(loop);
      }

      // Render
      function draw() {
        const w = canvas.clientWidth, h = canvas.clientHeight;
        // clear
        ctx.clearRect(0, 0, w, h);

        // background grid
        ctx.globalAlpha = 0.13;
        const grid = 24;
        for (let x = 0; x < w; x += grid) {
          ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, h); ctx.strokeStyle = '#2a335b'; ctx.lineWidth = 1; ctx.stroke();
        }
        for (let y = 0; y < h; y += grid) {
          ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(w, y); ctx.strokeStyle = '#24305a'; ctx.lineWidth = 1; ctx.stroke();
        }
        ctx.globalAlpha = 1;

        // target trail glow
        const g = ctx.createRadialGradient(state.circle.x, state.circle.y, 2, state.circle.x, state.circle.y, state.circle.r*2.2);
        g.addColorStop(0, 'rgba(139,211,255,0.25)');
        g.addColorStop(1, 'rgba(139,211,255,0)');
        ctx.fillStyle = g;
        ctx.beginPath(); ctx.arc(state.circle.x, state.circle.y, state.circle.r * 2.2, 0, Math.PI * 2); ctx.fill();

        // target
        ctx.beginPath();
        ctx.arc(state.circle.x, state.circle.y, state.circle.r, 0, Math.PI * 2);
        ctx.fillStyle = '#8bd3ff';
        ctx.shadowColor = '#8bd3ff';
        ctx.shadowBlur = 12;
        ctx.fill();
        ctx.shadowBlur = 0;

        // inner dot
        ctx.beginPath();
        ctx.arc(state.circle.x, state.circle.y, Math.max(3, state.circle.r * 0.25), 0, Math.PI * 2);
        ctx.fillStyle = '#a7ff83';
        ctx.fill();
      }

      // Initial paint
      draw(0);
    })();
  </script>
</body>
</html>
